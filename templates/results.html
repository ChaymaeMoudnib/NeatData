<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="static/models.css">
    <title></title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* General Styles */
        body {
            font-family: 'Raleway', sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #f0f8ff, #a2c2ec); /* Gradient background */
            color: #2c3e50;
            line-height: 1.6;
            scroll-behavior: smooth;}
        /* Header */
        .header {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            padding: 10px 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            width: 100%; /* Ensure full width */
            left: 0; /* Align to the left edge */
        }
        
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%; /* Allow navbar to take full width */
            max-width: 1700px; /* Optional: Set a max width for the navbar content */
            margin: 0 auto; /* Center the navbar content */
            height: 60px;
        }
        
        
        /* Logo */
        .LOGOIM {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo {
            height: 40px;
            transition: transform 0.3s ease;
        }
        
        .NEAT {
            font-size: 24px;
            font-weight: bold;
            color: rgb(84, 125, 240);
            text-decoration: none;
            letter-spacing: 1.5px;
            margin-top: -2px;
        }
        
        /* Navigation Links */
        .links ul {
            list-style: none;
            display: flex;
            gap: 20px;
            margin: 0;
            padding: 0;
            align-items: center;
        }
        
        .links ul li a {
            text-decoration: none;
            color: rgb(84, 125, 240);
            font-weight: 600;
            padding: 8px 12px;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-size: 18px;
            margin-top: -13px;
        }
        
        .links ul li a:hover {
            background: rgba(224, 242, 254, 0.8);
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        /* Upload Section */
        #uploadSection {
            max-width: 800px;
            margin: 40px auto;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .upload-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .file-drop-zone {
            display: flex;
            justify-content: center;
            align-items: center;
            background: rgba(224, 242, 254, 0.8);
            border: 2px dashed #2563eb;
            border-radius: 12px;
            padding: 40px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .file-drop-zone:hover {
            background: rgba(224, 242, 254, 1);
            border-color: #1e3a8a;
            transform: translateY(-3px);
        }
        
        .upload-icon {
            font-size: 2.5rem;
        }
        
        .browse-text span {
            color: #2563eb;
            font-weight: bold;
            text-decoration: underline;
        }
        
        .button-group {
            display: flex;
            justify-content: center;
            gap: 20px;
        }
        
        /* Enhanced Button Styles */
        .btn {
            padding: 12px 20px;
            font-size: 1rem;
            font-weight: 600;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: linear-gradient(90deg, rgb(84, 123, 206));
            color: white;
        }
        
        .btn-primary:hover {
            background: rgb(5, 40, 128);
        }
        
        .upload-message {
            text-align: center;
            margin-top: 20px;
            font-size: 1rem;
            color: #1e3a8a;
        }
        
        /* Report Section */
        #reportSection {
            max-width: 1200px;
            margin: 40px auto;
            padding: 24px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1)
            text-align: center; /* Center align text */
            ;
        }
        .stats-container {
            display: flex;
            justify-content: center;
            gap: 20px; /* Space between cards */
            margin: 20px 0; /* Space above and below */
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.9); /* Glassmorphism effect */
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            text-align: center; /* Center align text */
            width: 150px; /* Fixed width for cards */
        }
        
        .stat-card h2 {
            color: rgb(84, 125, 240); /* Use your preferred color */
            margin: 10px 0 0; /* Adjust margin for the heading */
        }
        
        
        .data-info {
            background: rgba(224, 242, 254, 0.8);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .data-info p {
            margin: 10px 0;
            font-size: 18px;
            color: #2c3e50;
        }
        
        .data-info span {
            font-weight: bold;
            color: #2563eb;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background: #2563eb;
            color: white;
            font-weight: bold;
        }
        
        tr:nth-child(even) {
            background: #f1f5f9;
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        
        .loader {
            border: 8px solid #f3f3f3;
            border-top: 8px solid #3498db;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        

        
        #reportSection  h2 {
            color: rgb(84, 125, 240); /* Use your preferred color */
            margin-bottom: 15px; /* Space below the heading */
            font-size: 1.5em; /* Adjust heading size */
        }
        
        #reportSection p {
            color: #333; /* Darker text for better contrast */
            font-size: 1.1em; /* Slightly larger font for readability */
            line-height: 1.5; /* Improve line spacing */
        }
        
    </style>
</head>
<body>
    <div id="reportSection" class="report-description">
        <div >
            <h2>Missing Data Analysis Report</h2>
            <p>This report helps you decide how to handle missing values by offering suggestions and analyzing patterns in the data. It includes visualizations like heatmaps and distribution plots, making it easier to choose the right imputation method.</p>
        </div>
            
        <h2 class="fade-in">Dataset Overview</h2>
        <div class="stats-container">
            <div class="stat-card">
                <p><strong>Number of Rows:</strong></p>
                <h2>{{ num_rows }}</h2>
            </div>
            <div class="stat-card">
                <p><strong>Number of Columns:</strong></p>
                <h2>{{ num_cols }}</h2>
            </div>
        </div>
    
        <h2 class="fade-in">Missing Data Summary</h2>
        <table>
            <thead>
                <tr>
                    <th>Column</th>
                    <th>Missing Percentage</th>
                    <th>Data Type</th>
                    <th>Top 2 Imputation Methods</th>
                    <th>Explanations</th>
                </tr>
            </thead>
            <tbody>
                {% for suggestion in suggestions %}
                <tr>
                    <td>{{ suggestion.column }}</td>
                    <td>{{ suggestion.missing_percentage }}%</td>
                    <td>{{ suggestion.dtype }}</td>
                    <td>
                        <ol>
                            {% for method in suggestion.suggested_methods %}
                            <li>{{ method }}</li>
                            {% endfor %}
                        </ol>
                    </td>
                    <td>
                        <ul>
                            {% for explanation in suggestion.explanations %}
                            <li>{{ explanation }}</li>
                            {% endfor %}
                        </ul>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    
        <h2 class="fade-in">Visualizations</h2>
        <h3>Missing Data Heatmap</h3>
        <img src="{{ web_images['heatmap'] }}" alt="Missing Data Heatmap" class="fade-in">
    
        <h3>Column Distributions</h3>
        {% for img in web_images['distributions'] %}
            <img src="{{ img }}" alt="Column Distribution" class="fade-in">
        {% endfor %}
    
        <h3>Correlation Matrix</h3>
        <img src="{{ web_images['correlation_matrix'] }}" alt="Correlation Matrix" class="fade-in">
    
        <h3>Spider Chart: Imputation Criteria</h3>
        <img src="{{ web_images['spider_chart'] }}" alt="Spider Chart" class="fade-in">

        <div class="button-group">
            <button id="generate-report" class="btn btn-primary">Generate Report</button>
            <div id="download-link" style="display: none;">
                <a id="report-link" href="#" class="btn btn-success" download> 📥 Download Report</a>
            </div>       
            <button class="btn btn-secondary" onclick="toggleTable()" title="View the criteria for imputation methods">The criteria</button>
        </div>
        <div id="imputationTable" style="display: none; margin-top: 20px;">
            <table border="1" style="width: 100%; border-collapse: collapse;">
                <thead>
                    <tr>
                        <th>Column Type</th>
                        <th>Missing %</th>
                        <th>Distribution</th>
                        <th>Best Imputation Method</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Numerical</td>
                        <td>< 5%</td>
                        <td>Normal</td>
                        <td>Mean Imputation</td>
                    </tr>
                    <tr>
                        <td>Numerical</td>
                        <td>< 5%</td>
                        <td>Skewed</td>
                        <td>Median Imputation</td>
                    </tr>
                    <tr>
                        <td>Numerical</td>
                        <td>5% - 30%</td>
                        <td>Any</td>
                        <td>KNN Imputation</td>
                    </tr>
                    <tr>
                        <td>Numerical</td>
                        <td> > 30%</td>
                        <td>Any</td>
                        <td>Drop Column</td>
                    </tr>
                    <tr>
                        <td>Categorical</td>
                        <td>< 5%</td>
                        <td>Low Cardinality</td>
                        <td>Mode Imputation</td>
                    </tr>
                    <tr>
                        <td>Categorical</td>
                        <td>< 5%</td>
                        <td>High Cardinality</td>
                        <td>Most Frequent Imputation</td>
                    </tr>
                    <tr>
                        <td>Categorical</td>
                        <td>5% - 30%</td>
                        <td>Any</td>
                        <td>MICE</td>
                    </tr>
                    <tr>
                        <td>Categorical</td>
                        <td> > 30%</td>
                        <td>Any</td>
                        <td>Drop Column</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <script>
        document.getElementById('generate-report').onclick = function() {
            fetch('/generate_report')
                .then(response => response.json())
                .then(data => {
                    if (data.filename) {
                        const reportLink = document.getElementById('report-link');
                        reportLink.href = `/download/${data.filename}`;  // Use the new report filename here
                        document.getElementById('download-link').style.display = 'block';  // Show the link
                    } else {
                        alert(data.error);
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        };
        function toggleTable() {
            const table = document.getElementById('imputationTable');
            if (table.style.display === 'none') {
                table.style.display = 'block';
            } else {
                table.style.display = 'none';
            }
        }
    </script>
</body>
</html>